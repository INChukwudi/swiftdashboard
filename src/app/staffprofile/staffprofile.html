		<!--begin::App-->
		<div class="d-flex flex-column flex-root app-root" id="kt_app_root">
			<!--begin::Page-->
			<div class="app-page flex-column flex-column-fluid" id="kt_app_page">
				<!--begin::Header-->
				<div id="kt_app_header" class="app-header" data-kt-sticky="true" data-kt-sticky-activate="{default: true, lg: true}" data-kt-sticky-name="app-header-minimize" data-kt-sticky-offset="{default: '200px', lg: '0'}" data-kt-sticky-animation="false">
					<!--begin::Header container-->
					<div class="app-container container-fluid d-flex align-items-stretch justify-content-between" id="kt_app_header_container">
						<!--begin::Sidebar mobile toggle-->
						<div class="d-flex align-items-center d-lg-none ms-n3 me-1 me-md-2" title="Show sidebar menu">
							<div class="btn btn-icon btn-active-color-primary w-35px h-35px" id="kt_app_sidebar_mobile_toggle">
								<i class="ki-duotone ki-abstract-14 fs-2 fs-md-1">
									<span class="path1"></span>
									<span class="path2"></span>
								</i>
							</div>
						</div>
						<!--end::Sidebar mobile toggle-->
						<!--begin::Mobile logo-->
						<div class="d-flex align-items-center flex-grow-1 flex-lg-grow-0">
							<a href="index.html" class="d-lg-none">
								<img alt="Logo" src="assets/swiftlogo.png" class="h-30px" />
							</a>
						</div>
						<!--end::Mobile logo-->
						<!--begin::Header wrapper-->
						<div class="d-flex align-items-stretch justify-content-between flex-lg-grow-1" id="kt_app_header_wrapper">
							<!--begin::Menu wrapper-->
							<div class="app-header-menu app-header-mobile-drawer align-items-center" data-kt-drawer="true" data-kt-drawer-name="app-header-menu" data-kt-drawer-activate="{default: true, lg: false}" data-kt-drawer-overlay="true" data-kt-drawer-width="250px" data-kt-drawer-direction="end" data-kt-drawer-toggle="#kt_app_header_menu_toggle" data-kt-swapper="true" data-kt-swapper-mode="{default: 'append', lg: 'prepend'}" data-kt-swapper-parent="{default: '#kt_app_body', lg: '#kt_app_header_wrapper'}">
								<h1 class="title">Employee Profile</h1>
							</div>
							<!--end::Menu wrapper-->
							<!--begin::Navbar-->
							<div class="app-navbar flex-shrink-0">
								<!--begin::Chat-->
								<div class="app-navbar-item ms-1 ms-md-4">
									<!--begin::Menu wrapper-->
									<div class="btn btn-icon btn-custom btn-icon-muted btn-active-light btn-active-color-primary w-35px h-35px position-relative" id="kt_drawer_chat_toggle">
										<i class="ki-duotone ki-message-notif fs-2">
												<span class="path1"></span>
												<span class="path2"></span>
												<span class="path3"></span>
												<span class="path4"></span>
												<span class="path5"></span>
										</i>
										<span class="bullet bullet-dot bg-success h-6px w-6px position-absolute translate-middle top-0 start-50 animation-blink"></span>
									</div>
									<!--end::Menu wrapper-->
								</div>
								<!--end::Chat-->
								
								<!--begin::Theme mode-->
								<div class="app-navbar-item ms-1 ms-md-4">
									<!--begin::Menu toggle-->
									<a href="#" class="btn btn-icon btn-custom btn-icon-muted btn-active-light btn-active-color-primary w-35px h-35px" data-kt-menu-trigger="{default:'click', lg: 'hover'}" data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end">
										<i class="ki-duotone ki-night-day theme-light-show fs-1">
											<span class="path1"></span>
											<span class="path2"></span>
											<span class="path3"></span>
											<span class="path4"></span>
											<span class="path5"></span>
											<span class="path6"></span>
											<span class="path7"></span>
											<span class="path8"></span>
											<span class="path9"></span>
											<span class="path10"></span>
										</i>
										<i class="ki-duotone ki-moon theme-dark-show fs-1">
											<span class="path1"></span>
											<span class="path2"></span>
										</i>
									</a>
									<!--begin::Menu toggle-->
									<!--begin::Menu-->
									<div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-title-gray-700 menu-icon-gray-500 menu-active-bg menu-state-color fw-semibold py-4 fs-base w-150px" data-kt-menu="true" data-kt-element="theme-mode-menu">
										<!--begin::Menu item-->
										<div class="menu-item px-3 my-0">
											<a href="#" class="menu-link px-3 py-2" data-kt-element="mode" data-kt-value="light">
												<span class="menu-icon" data-kt-element="icon">
													<i class="ki-duotone ki-night-day fs-2">
														<span class="path1"></span>
														<span class="path2"></span>
														<span class="path3"></span>
														<span class="path4"></span>
														<span class="path5"></span>
														<span class="path6"></span>
														<span class="path7"></span>
														<span class="path8"></span>
														<span class="path9"></span>
														<span class="path10"></span>
													</i>
												</span>
												<span class="menu-title">Light</span>
											</a>
										</div>
										<!--end::Menu item-->
										<!--begin::Menu item-->
										<div class="menu-item px-3 my-0">
											<a href="#" class="menu-link px-3 py-2" data-kt-element="mode" data-kt-value="dark">
												<span class="menu-icon" data-kt-element="icon">
													<i class="ki-duotone ki-moon fs-2">
														<span class="path1"></span>
														<span class="path2"></span>
													</i>
												</span>
												<span class="menu-title">Dark</span>
											</a>
										</div>
										<!--end::Menu item-->
										<!--begin::Menu item-->
										<div class="menu-item px-3 my-0">
											<a href="#" class="menu-link px-3 py-2" data-kt-element="mode" data-kt-value="system">
												<span class="menu-icon" data-kt-element="icon">
													<i class="ki-duotone ki-screen fs-2">
														<span class="path1"></span>
														<span class="path2"></span>
														<span class="path3"></span>
														<span class="path4"></span>
													</i>
												</span>
												<span class="menu-title">System</span>
											</a>
										</div>
										<!--end::Menu item-->
									</div>
									<!--end::Menu-->
								</div>
								<!--end::Theme mode-->
								<!--begin::User menu-->
								<div class="app-navbar-item ms-1 ms-md-4" id="kt_header_user_menu_toggle">
									<!--begin::Menu wrapper-->
									<div class="cursor-pointer symbol symbol-35px" data-kt-menu-trigger="{default: 'click', lg: 'hover'}" data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end">
										<img src="assets/pixelsicon.png" class="rounded-3" alt="user" />
									</div>
									<!--begin::User account menu-->
									<div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg menu-state-color fw-semibold py-4 fs-6 w-275px" data-kt-menu="true">
										<!--begin::Menu item-->
										<div class="menu-item px-3">
											<div class="menu-content d-flex align-items-center px-3">
												<!--begin::Avatar-->
												<div class="symbol symbol-50px me-5">
													<img alt="Logo" src="assets/pixelsicon.png" />
												</div>
												<!--end::Avatar-->
												<!--begin::Username-->
												<div class="d-flex flex-column">
													<div class="fw-bold d-flex align-items-center fs-5">Pixels Solutiin Ltd
													<span class="badge badge-light-success fw-bold fs-8 px-2 py-1 ms-2">Pro</span></div>
													
												</div>
												<!--end::Username-->
											</div>
										</div>
										<!--end::Menu item-->
										
										<!--begin::Menu separator-->
										<div class="separator my-2"></div>
										<!--end::Menu separator-->
										<!--begin::Menu item-->
										<div class="menu-item px-5" data-kt-menu-trigger="{default: 'click', lg: 'hover'}" data-kt-menu-placement="left-start" data-kt-menu-offset="-15px, 0">
											<a href="#" class="menu-link px-5">
												<span class="menu-title position-relative">Mode 
												<span class="ms-5 position-absolute translate-middle-y top-50 end-0">
													<i class="ki-duotone ki-night-day theme-light-show fs-2">
														<span class="path1"></span>
														<span class="path2"></span>
														<span class="path3"></span>
														<span class="path4"></span>
														<span class="path5"></span>
														<span class="path6"></span>
														<span class="path7"></span>
														<span class="path8"></span>
														<span class="path9"></span>
														<span class="path10"></span>
													</i>
													<i class="ki-duotone ki-moon theme-dark-show fs-2">
														<span class="path1"></span>
														<span class="path2"></span>
													</i>
												</span></span>
											</a>
											<!--begin::Menu-->
											<div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-title-gray-700 menu-icon-gray-500 menu-active-bg menu-state-color fw-semibold py-4 fs-base w-150px" data-kt-menu="true" data-kt-element="theme-mode-menu">
												<!--begin::Menu item-->
												<div class="menu-item px-3 my-0">
													<a href="#" class="menu-link px-3 py-2" data-kt-element="mode" data-kt-value="light">
														<span class="menu-icon" data-kt-element="icon">
															<i class="ki-duotone ki-night-day fs-2">
																<span class="path1"></span>
																<span class="path2"></span>
																<span class="path3"></span>
																<span class="path4"></span>
																<span class="path5"></span>
																<span class="path6"></span>
																<span class="path7"></span>
																<span class="path8"></span>
																<span class="path9"></span>
																<span class="path10"></span>
															</i>
														</span>
														<span class="menu-title">Light</span>
													</a>
												</div>
												<!--end::Menu item-->
												<!--begin::Menu item-->
												<div class="menu-item px-3 my-0">
													<a href="#" class="menu-link px-3 py-2" data-kt-element="mode" data-kt-value="dark">
														<span class="menu-icon" data-kt-element="icon">
															<i class="ki-duotone ki-moon fs-2">
																<span class="path1"></span>
																<span class="path2"></span>
															</i>
														</span>
														<span class="menu-title">Dark</span>
													</a>
												</div>
												<!--end::Menu item-->
												<!--begin::Menu item-->
												<div class="menu-item px-3 my-0">
													<a href="#" class="menu-link px-3 py-2" data-kt-element="mode" data-kt-value="system">
														<span class="menu-icon" data-kt-element="icon">
															<i class="ki-duotone ki-screen fs-2">
																<span class="path1"></span>
																<span class="path2"></span>
																<span class="path3"></span>
																<span class="path4"></span>
															</i>
														</span>
														<span class="menu-title">System</span>
													</a>
												</div>
												<!--end::Menu item-->
											</div>
											<!--end::Menu-->
										</div>
										<!--end::Menu item-->
									
										<!--begin::Menu item-->
										<div class="menu-item px-5 my-1">
											<a href="#" class="menu-link px-5">Account Settings</a>
										</div>
										<!--end::Menu item-->
										<!--begin::Menu item-->
										<div class="menu-item px-5">
											<a href="#" class="menu-link px-5">Sign Out</a>
										</div>
										<!--end::Menu item-->
									</div>
									<!--end::User account menu-->
									<!--end::Menu wrapper-->
								</div>
								<!--end::User menu-->
								
								<!--begin::Aside toggle-->
								<!--end::Header menu toggle-->
							</div>
							<!--end::Navbar-->
						</div>
						<!--end::Header wrapper-->
					</div>
					<!--end::Header container-->
				</div>
				<!--end::Header-->
				<!--begin::Wrapper-->
				<div class="app-wrapper flex-column flex-row-fluid" id="kt_app_wrapper">
				
					<!--begin::Main-->
					<div class="app-main flex-column flex-row-fluid" id="kt_app_main">
						<!--begin::Content wrapper-->
						<div class="d-flex flex-column flex-column-fluid">
							
							<!--begin::Content-->
							<div id="kt_app_content" class="app-content flex-column-fluid">
								<!--begin::Content container-->
								<div id="kt_app_content_container" class="app-container container-fluid">
<!-- Employee Profile Header Card - Fixed with Correct API Properties -->
<div class="row g-5 gx-xl-10 mb-5 mb-xl-5">
  <div class="card border-transparent" data-bs-theme="light" 
       style="background-color: #1800ad; background-image: url('assets/background.png'); background-position: center center; background-size: cover; background-repeat: no-repeat;">
      <div class="card-body pt-9 pb-0">
          
          <!-- Loading State -->
          <div *ngIf="isLoadingEmployee" class="text-center py-10">
              <div class="spinner-border text-white" role="status">
                  <span class="visually-hidden">Loading...</span>
              </div>
              <div class="mt-3 text-white fw-semibold">Loading employee data...</div>
          </div>

          <!-- Employee Profile Content -->
          <div *ngIf="!isLoadingEmployee" class="d-flex flex-wrap flex-sm-nowrap mb-6">
              <!-- Avatar -->
              <div class="me-7">
                  <img [src]="getAvatarUrl()" 
                       alt="Employee Photo" 
                       class="w-150px h-200px rounded object-fit-cover">
              </div>
              
              <!-- Employee Info -->
              <div class="flex-grow-1">
                  <div class="d-flex justify-content-between align-items-start flex-wrap mb-2">
                      
                      <!-- Left Side: Name, Job, Stats -->
                      <div class="d-flex flex-column mt-10">
                          <!-- Name and Job Title -->
                          <div class="d-flex flex-column align-items-start mb-5">
                              <div class="text-white fs-2 fw-bold mb-2">{{ getFullName() }}</div>
                              <span class="badge badge-light-primary">{{ employee?.job || 'N/A' }}</span>
                          </div>
                          
                          <!-- Stats Cards - From API -->
                          <div class="d-flex flex-wrap justify-content-start">
                              <!-- Staff ID -->
                              <div class="rounded min-w-125px py-3 px-4 me-6 mb-3 stats-card"
                                   style="border: 0.5px dashed white; color: white;">
                                  <div class="fs-4 fw-bold text-white">{{ employee?.employeeId || 'N/A' }}</div>
                                  <div class="fw-semibold fs-6 text-white">Staff ID</div>
                              </div>
                              
                              <!-- Department -->
                              <div class="rounded min-w-125px py-3 px-4 me-6 mb-3 stats-card"
                                   style="border: 0.5px dashed white; color: white;">
                                  <div class="fs-4 fw-bold text-white">{{ employee?.department || 'N/A' }}</div>
                                  <div class="fw-semibold fs-6 text-white">Department</div>
                              </div>
                              
                              <!-- Daily Rank (from daily-progress API: data.rank) -->
                              <div class="rounded min-w-125px py-3 px-4 me-6 mb-3 stats-card"
                                   style="border: 0.5px dashed white; color: white;">
                                  <div class="fs-4 fw-bold text-white">
                                      <ng-container *ngIf="dailyProgress?.rank || employee?.dailyRank; else noDailyRank">
                                          {{ dailyProgress?.rank || employee?.dailyRank }}<span class="fs-6">{{ getDayRankSuffix(dailyProgress?.rank || employee?.dailyRank) }}</span>
                                      </ng-container>
                                      <ng-template #noDailyRank>N/A</ng-template>
                                  </div>
                                  <div class="fw-semibold fs-6 text-white">Daily Rank</div>
                              </div>
                              
                              <!-- Daily Points (from daily-progress API: data.totalPoint) -->
                              <div class="rounded min-w-125px py-3 px-4 me-6 mb-3 stats-card"
                                   style="border: 0.5px dashed white; color: white;">
                                  <div class="fs-4 fw-bold text-white">
                                      {{ dailyProgress?.totalPoint || dailyProgress?.dailyAttendancePoint || employee?.dailyPoint || 0 }}
                                  </div>
                                  <div class="fw-semibold fs-6 text-white">Daily Points</div>
                              </div>
                              
                              <!-- Monthly Rank (from daily-progress API: data.monthlyRank OR employee API) -->
                              <div class="rounded min-w-125px py-3 px-4 me-6 mb-3 stats-card" style="border: 0.5px dashed white; color: white;">
                                  <div class="fs-4 fw-bold text-white">
                                      <ng-container *ngIf="dailyProgress?.monthlyRank || employee?.monthlyRank; else noMonthlyRank">
                                          {{ dailyProgress?.monthlyRank || employee?.monthlyRank }}<span class="fs-6">{{ getDayRankSuffix(dailyProgress?.monthlyRank || employee?.monthlyRank) }}</span>
                                      </ng-container>
                                      <ng-template #noMonthlyRank>N/A</ng-template>
                                  </div>
                                  <div class="fw-semibold fs-6 text-white">Monthly Rank</div>
                              </div>
                              
                              <!-- Monthly Points (from daily-progress API: data.monthlyTotalPoint OR employee API) -->
                              <div class="rounded min-w-125px py-3 px-4 me-6 mb-3 stats-card"
                                   style="border: 0.5px dashed white; color: white;">
                                  <div class="fs-4 fw-bold text-white">
                                      {{ dailyProgress?.monthlyTotalPoint || employee?.monthlyPoint || 0 }}
                                  </div>
                                  <div class="fw-semibold fs-6 text-white">Monthly Points</div>
                              </div>
                          </div>
                      </div>
                      
                      <!-- Right Side: Action Buttons -->
                      <div class="d-flex mb-4">
                          <a href="#" 
                             class="btn btn-sm btn-light me-3" 
                             data-bs-toggle="modal" 
                             data-bs-target="#ProfileModal">
                              <i class="ki-outline ki-profile-user fs-4 me-1"></i>
                              About Staff
                          </a>
                          <a href="#" 
                             class="btn btn-sm btn-light me-3" 
                             (click)="createNewTask(); $event.preventDefault()">
                              <i class="ki-outline ki-plus fs-4 me-1"></i>
                              Create New Task
                          </a>
                          <a href="#" 
                             class="btn btn-sm text-white btn-primary" 
                             (click)="downloadLog(); $event.preventDefault()">
                              <i class="ki-outline ki-cloud-download fs-4 me-1"></i>
                              Download Log
                          </a>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div>
</div>

<style>
.stats-card {
  transition: all 0.2s ease;
}

.stats-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(255, 255, 255, 0.2);
}

.object-fit-cover {
  object-fit: cover;
}
</style>

                                     <!-- Student Profile Modal -->
              <div class="modal fade" id="ProfileModal" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered mw-750px">
                    <div class="modal-content">
            
                        <!-- Modal Header -->
                        <div class="modal-header">
                            <h2 class="fw-bold">Staff Profile</h2>
                            <div class="btn btn-icon btn-sm btn-active-light-primary ms-2" data-bs-dismiss="modal" aria-label="Close">
                                <i class="ki-outline ki-cross fs-2x"></i>
                            </div>
                        </div>
            
                        <!-- Modal Body -->
                        <div class="modal-body scroll-y mx-5 mx-xl-15 my-7">
            
                            <!-- Staff Info -->
                            <div class="d-flex align-items-center mb-6">
                                <img [src]="getAvatarUrl()" 
                                     alt="Staff Image"
                                     class="w-120px h-150px rounded me-5 border border-2 border-gray-200">
                                <div>
                                  <h3 class="fw-bold text-gray-800 mb-1">{{ getFullName() }}</h3>
                                  <p class="text-gray-600 mb-2">{{ employee?.job }}</p>
                                  <p class="mb-1"><strong>Department:</strong> {{ employee?.department || 'N/A' }}</p>
                                  <p class="mb-1"><strong>Date Employed:</strong> {{ formatDate(employee?.joinedAt || '') }}</p>
                                  <p class="mb-1"><strong>Staff ID:</strong> {{ employee?.employeeId }}</p>
                                  <p class="mb-1"><strong>Email:</strong> {{ employee?.email }}</p>
                                  <p class="mb-1"><strong>Phone:</strong> {{ employee?.phoneNumber }}</p>
                                  <p class="mb-1"><strong>Status:</strong> 
                                    <span class="badge" 
                                          [ngClass]="employee?.deactivated ? 'badge-danger' : 'badge-light-success'">
                                      {{ employee?.deactivated ? 'Deactivated' : 'Active' }}
                                    </span>
                                  </p>
                                </div>
                              </div>
            
                            <hr class="my-5">
            
                            <!-- Skills & Expertise -->
                            <h4 class="fw-bold mb-4">Skills & Expertise</h4>
                            <div class="row g-3 mb-6">
                              <div class="col-12">
                                <ng-container *ngIf="employee as emp">
                                    <ul class="list-unstyled mb-0">
                                      <li *ngFor="let skill of emp.skills">
                                        <i class="bi bi-check-circle text-success me-2"></i>{{ skill }}
                                      </li>
                                  
                                      <li *ngIf="emp.skills.length === 0" class="text-muted">
                                        No skills listed
                                      </li>
                                    </ul>
                                  </ng-container>
                              </div>
                            </div>
            
                            <hr class="my-5">
            
                            <!-- Qualifications -->
                            <h4 class="fw-bold mb-4">Qualifications</h4>
                            <div class="row g-3">
                            
                                <div class="col-md-6">
                                    <div class="border rounded p-4 bg-light">
                                        <p class="fw-semibold mb-1">Certificate in Frontend Engineering</p>
                                        <p class="text-gray-600 mb-0 small">Pixels Academy, 2021</p>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="border rounded p-4 bg-light">
                                        <p class="fw-semibold mb-1">Professional Diploma in Software Engineering</p>
                                        <p class="text-gray-600 mb-0 small">NIIT, 2022</p>
                                    </div>
                                </div>
                            </div>
            
                            <!-- Footer Buttons -->
                            <div class="text-center mt-8">
                                <button type="button" class="btn btn-light me-3" data-bs-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary text-white">Download Profile</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row gx-5 gx-xl-10 mt-10">
              <div class="col-12 mb-5 mb-xl-10">
            <!-- ACTIVITY & ATTENDANCE OVERVIEW - FIXED VERSION -->

<div class="card card-flush">
  

  <div class="card-body pt-6">

    <!-- ===== SAME ROW ===== -->
    <div class="row gx-5 gx-xl-10 align-items-stretch">

      <!-- ===== LEFT (7 COL) ===== -->
      <div class="col-xl-7">

        <div class="d-flex justify-content-between align-items-center mb-5">
          <div>
            <h4 class="fw-bold text-gray-800 mb-1">Activity Log</h4>
            <span class="text-gray-500 fs-7">Monthly activity overview</span>
          </div>

          <div class="d-flex gap-3">
            <select class="form-select form-select-solid w-125px">
              <option selected>October</option>
            </select>
            <select class="form-select form-select-solid w-100px">
              <option>Week 1</option>
              <option>Week 2</option>
              <option>Week 3</option>
              <option>Week 4</option>
            </select>
            <button class="btn btn-primary btn-sm">
              <i class="bi bi-funnel"></i>
            </button>
          </div>
        </div>

        <!-- Stats - FIXED TO USE TASK DATA -->
        <div class="row g-5 mb-8">
          <!-- Total Tasks -->
          <div class="col-md-3 col-6">
            <div class="border border-dashed rounded p-4 text-center bg-light-primary">
              <div class="fs-3 fw-bold text-primary">{{ totalTasks }}</div>
              <div class="fs-8">Total Task</div>
            </div>
          </div>
          
          <!-- Completed Tasks -->
          <div class="col-md-3 col-6">
            <div class="border border-dashed rounded p-4 text-center bg-light-success">
              <div class="fs-3 fw-bold text-success">{{ stats.tasksCompleted }}</div>
              <div class="fs-8">Completed</div>
            </div>
          </div>
          
          <!-- Overdue Tasks -->
          <div class="col-md-3 col-6">
            <div class="border border-dashed rounded p-4 text-center bg-light-danger">
              <div class="fs-3 fw-bold text-danger">{{ stats.overdueTasks }}</div>
              <div class="fs-8">Overdue</div>
            </div>
          </div>
          
          <!-- Performance -->
          <div class="col-md-3 col-6">
            <div class="border border-dashed rounded p-4 text-center bg-light-info">
              <div class="fs-3 fw-bold text-info">{{ stats.inProgress }}</div>
              <div class="fs-8">In Progress</div>
            </div>
          </div>
        </div>

        <!-- Timeline - Loading State -->
        <div *ngIf="isLoadingActivities" class="text-center py-10">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading activities...</span>
          </div>
        </div>

        <!-- Timeline - Actual Data -->
        <div *ngIf="!isLoadingActivities" class="timeline-label" style="max-height: 450px; overflow-y: auto;">
          <!-- No Activities -->
          <div *ngIf="activities.length === 0" class="text-center py-10">
            <i class="ki-outline ki-information-5 fs-3x text-gray-400 mb-3 d-block"></i>
            <div class="fs-6 fw-semibold text-muted">No recent activities</div>
          </div>
          
          <!-- Activity Items -->
          <div *ngFor="let activity of activities; trackBy: trackByActivityId" class="timeline-item">
            <div class="timeline-label fs-7 fw-bold text-gray-600">
              {{ formatTime(activity.timestamp) }}
            </div>
            <div class="timeline-badge">
              <i class="fa fa-genderless fs-1" [ngClass]="'text-' + activity.color"></i>
            </div>
            <div class="timeline-content ps-3 mb-5">
              <div class="fw-bold text-gray-800">{{ activity.action }}</div>
              <div class="text-gray-600 fs-7">{{ activity.description }}</div>
            </div>
          </div>
        </div>

      </div>

      <!-- ===== RIGHT (5 COL) ===== -->
      <div class="col-xl-5">

        <h4 class="fw-bold text-gray-800 mb-4">Clock In / Out Register</h4>

        <!-- Loading State -->
        <div *ngIf="isLoadingAttendance" class="text-center py-10">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading attendance...</span>
          </div>
        </div>

        <!-- Attendance Table -->
        <div *ngIf="!isLoadingAttendance" class="table-responsive">
          <table class="table table-row-dashed align-middle gs-0 gy-3 my-0">
              <thead>
                  <tr class="fs-7 fw-bold text-gray-500 border-bottom-0">
                      <th class="p-0 pb-3 min-w-150px text-start">Day</th>
                      <th class="p-0 pb-3 min-w-100px text-start">Clock In</th>
                      <th class="p-0 pb-3 min-w-100px text-start">Clock Out</th>
                      <th class="p-0 pb-3 min-w-150px text-end">Working Hours</th>
                  </tr>
              </thead>
              <tbody>
                  <!-- No Attendance Data -->
                  <tr *ngIf="attendance.length === 0">
                      <td colspan="4" class="text-center py-8 text-muted">
                          <i class="ki-outline ki-information-5 fs-2x text-gray-400 mb-2 d-block"></i>
                          <div class="fs-7">No attendance records this week</div>
                      </td>
                  </tr>

                  <!-- Attendance Rows -->
                  <tr *ngFor="let item of attendance; trackBy: trackByDay">
                      <td>
                          <div class="d-flex align-items-center">
                              <div class="symbol symbol-50px me-3" data-bs-toggle="tooltip" [title]="item.day">
                                  <span class="symbol-label bg-primary text-inverse-primary fw-bold">{{ item.short }}</span>
                              </div>
                              <div class="d-flex justify-content-start flex-column">
                                  <div class="text-gray-800 fw-bold fs-6">{{ item.day }}</div>
                              </div>
                          </div>
                      </td>
                      <td>
                          <span class="text-gray-600 fw-bold fs-6" 
                                [class.text-muted]="item.clockIn === '--:--'">
                              {{ item.clockIn }}
                          </span>
                      </td>
                      <td>
                          <span class="text-gray-600 fw-bold fs-6"
                                [class.text-muted]="item.clockOut === '--:--'">
                              {{ item.clockOut }}
                          </span>
                      </td>
                      <td class="text-end">
                          <div class="d-flex flex-column align-items-end">
                              <span class="badge fs-7 fw-bold mb-1"
                                    [class.badge-light-success]="item.status === 'success'"
                                    [class.badge-light-warning]="item.status === 'warning'"
                                    [class.badge-light-danger]="item.status === 'danger'">
                                  {{ item.hours }}
                              </span>
                              <div class="d-flex align-items-center">
                                  <div class="progress h-6px w-100px me-2">
                                      <div class="progress-bar"
                                           [class.bg-success]="item.status === 'success'"
                                           [class.bg-warning]="item.status === 'warning'"
                                           [class.bg-danger]="item.status === 'danger'"
                                           role="progressbar" 
                                           [style.width.%]="item.percentage">
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </td>
                  </tr>
              </tbody>
              
              <!-- Footer Summary -->
              <tfoot *ngIf="attendance.length > 0">
                  <tr class="border-top border-top-dashed">
                      <td colspan="3" class="pt-4">
                          <span class="text-gray-800 fw-bold fs-6">Total Weekly Hours</span>
                      </td>
                      <td class="text-end pt-4">
                          <div class="d-flex flex-column align-items-end">
                              <span class="badge badge-light-primary fs-6 fw-bold mb-1">
                                  {{ totalWeeklyHours }} / {{ totalTarget }}
                              </span>
                              <div class="d-flex align-items-center">
                                  <div class="progress h-8px w-100px me-2">
                                      <div class="progress-bar"
                                           [class.bg-success]="weeklyPercentage >= 95"
                                           [class.bg-primary]="weeklyPercentage >= 75 && weeklyPercentage < 95"
                                           [class.bg-warning]="weeklyPercentage >= 50 && weeklyPercentage < 75"
                                           [class.bg-danger]="weeklyPercentage < 50"
                                           role="progressbar" 
                                           [style.width.%]="weeklyPercentage">
                                      </div>
                                  </div>
                                  <span class="fw-bold fs-7"
                                        [class.text-success]="weeklyPercentage >= 95"
                                        [class.text-primary]="weeklyPercentage >= 75 && weeklyPercentage < 95"
                                        [class.text-warning]="weeklyPercentage >= 50 && weeklyPercentage < 75"
                                        [class.text-danger]="weeklyPercentage < 50">
                                      {{ weeklyPercentage }}%
                                  </span>
                              </div>
                          </div>
                      </td>
                  </tr>
              </tfoot>
              
          </table>
      </div>
        
        
        <!-- Legend -->
        <div *ngIf="!isLoadingAttendance && attendance.length > 0" 
             class="mt-6 pt-3 border-top border-gray-300">
          <div class="d-flex flex-wrap gap-4">
            <div class="d-flex align-items-center">
              <div class="w-15px h-15px rounded bg-success me-2"></div>
              <span class="text-gray-600 fs-7 fw-semibold">â‰¥ 8 hours (Full Day)</span>
            </div>
            <div class="d-flex align-items-center">
              <div class="w-15px h-15px rounded bg-warning me-2"></div>
              <span class="text-gray-600 fs-7 fw-semibold">6-7.9 hours (Partial)</span>
            </div>
            <div class="d-flex align-items-center">
              <div class="w-15px h-15px rounded bg-danger me-2"></div>
              <span class="text-gray-600 fs-7 fw-semibold">< 6 hours (Incomplete)</span>
            </div>
          </div>
        </div>
        
      </div>

    </div>
    <!-- End Row -->

  </div>
  <!-- End Card Body -->
</div>
<!-- End Card -->
  <!-- TASK OVERVIEW SECTION WITH TABLE/CARD VIEW TOGGLE -->
<div class="card card-flush px-10 mt-10 py-10">
<!--begin::Toolbar-->
<div class="d-flex flex-wrap flex-stack pt-5 pb-5">
  <!--begin::Heading-->
  <h3 class="fw-bold my-2">
     Task Overview 
  </h3>
  <!--end::Heading-->

  <!--begin::Controls-->
  <div class="d-flex flex-wrap my-1 gap-3">
      <!-- View Toggle Buttons -->
      <ul class="nav nav-pills mb-0">
        <li class="nav-item m-0">
          <button 
            class="btn btn-sm btn-icon me-2" 
            [ngClass]="{'btn-primary': selectedView === 'table', 'btn-outline-primary': selectedView !== 'table'}"
            (click)="selectView('table')" 
            title="Table View">
            <i class="bi bi-list-ul fs-4"></i>
          </button>
        </li>
        
        <li class="nav-item m-0">
          <button 
            class="btn btn-sm btn-icon" 
            [ngClass]="{'btn-primary': selectedView === 'card', 'btn-outline-primary': selectedView !== 'card'}"
            (click)="selectView('card')" 
            title="Card View">
            <i class="bi bi-grid-3x3-gap-fill fs-4"></i>
          </button>
        </li> 
      </ul>

      <a href="#" class="btn btn-primary btn-sm text-white fw-bolder" 
         data-bs-toggle="modal" 
         data-bs-target="#kt_modal_new_target">
        <i class="ki-outline ki-plus fs-4"></i>
        Assign New Task
      </a>
  </div>
  <!--end::Controls-->
</div>
<!--end::Toolbar-->

<!--begin::Tab Content-->
<div class="tab-content">

  <!--begin::Tab pane-->
  <div id="kt_project_targets_table_pane" class="tab-pane mb-10 show active fade">
    
    <!-- Loading State (Outside views) -->
    <div *ngIf="isLoadingTasks" class="text-center py-10">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <div class="mt-3 text-muted fw-semibold">Loading tasks...</div>
    </div>

    <!-- TABLE VIEW -->
    <div *ngIf="!isLoadingTasks && selectedView === 'table'" class="card card-flush">
      <div class="card-body pt-3">
          <!--begin::Table-->
          <table id="kt_profile_overview_table" class="table table-row-bordered table-row-dashed gy-4 align-middle fw-bold">
              <!--begin::Table head-->
              <thead class="fs-7 text-gray-400 text-uppercase">
                  <tr>
                      <th class="min-w-250px">Task</th>
                      <th class="min-w-90px">Project</th>
                      <th class="min-w-90px">Start Date</th>
                      <th class="min-w-90px">Due Date</th>
                      <th class="min-w-90px">Assigned By</th>
                      <th class="min-w-90px">Collaborators</th>
                      <th class="min-w-70px">Progress</th>
                      <th class="min-w-90px">Status</th>
                      <th class="min-w-50px text-end">Actions</th>
                  </tr>
              </thead>
              <!--end::Table head-->

              <!--begin::Table body-->
              <tbody class="fs-6">
                  <!-- No Tasks -->
                  <tr *ngIf="tasks.length === 0">
                    <td colspan="8" class="text-center py-10">
                      <i class="ki-outline ki-information-5 fs-3x text-gray-400 mb-3 d-block"></i>
                      <div class="fs-5 fw-semibold text-muted">No tasks assigned to this employee yet</div>
                    </td>
                  </tr>
                  
                  <!-- Task Rows -->
                  <tr *ngFor="let task of tasks; trackBy: trackByTaskId">
                    <td class="fw-bold">
                      <a href="#" 
                         class="text-gray-900 text-hover-primary"
                         (click)="openTaskDrawer(task); $event.preventDefault()">
                        {{ task.title }}
                      </a>
                    </td>
                    
                    <td>
                      <span class="badge badge-light-primary fw-semibold">
                        {{ getProjectName(task) }}
                      </span>
                    </td>
                    
                    <td><span class="text-dark">{{ formatDate(task.startDate) }}</span></td>
                    <td><span class="text-dark">{{ formatDate(task.dueDate) }}</span></td>
                    <td>
                      <div class="d-flex align-items-center" *ngIf="task.assignee">
                        <div class="symbol symbol-35px symbol-circle me-3">
                          <img 
                            *ngIf="task.assignee.avatarUrl"
                            [src]="task.assignee.avatarUrl" 
                            [alt]="task.assignee.firstName + ' ' + task.assignee.lastName"
                            class="object-fit-cover rounded-circle">
                          <span 
                            *ngIf="!task.assignee.avatarUrl"
                            class="symbol-label bg-primary text-inverse-primary fw-bold">
                            {{getInitials(task.assignee.firstName, task.assignee.lastName)}}
                          </span>
                        </div>
                        <div class="fw-semibold">
                          <div class="text-gray-900 fw-bold fs-6">
                            {{ task.assignee.firstName }} {{ task.assignee.lastName }}
                          </div>
                        </div>
                      </div>
                      <span class="text-muted" *ngIf="!task.assignee">Not assigned</span>
                    </td>
                    <td>
                      <div class="symbol-group symbol-hover">
                        <div *ngFor="let collab of task.collaborators?.slice(0, 4)" 
                             class="symbol symbol-25px symbol-circle"
                             [attr.data-bs-toggle]="'tooltip'"
                             [attr.title]="collab.firstName + ' ' + collab.lastName">
                          <img *ngIf="collab.avatarUrl" 
                               [alt]="collab.firstName" 
                               [src]="collab.avatarUrl"
                               class="object-fit-cover" />
                          <span *ngIf="!collab.avatarUrl" 
                                class="symbol-label bg-primary text-inverse-primary fw-bold">
                            {{ getInitials(collab.firstName, collab.lastName) }}
                          </span>
                        </div>
                        <div *ngIf="task.collaborators && task.collaborators.length > 4"
                             class="symbol symbol-25px symbol-circle"
                             [attr.data-bs-toggle]="'tooltip'"
                             [attr.title]="(task.collaborators.length - 4) + ' more'">
                          <span class="symbol-label bg-dark text-gray-300 fw-bold">
                            +{{ task.collaborators.length - 4 }}
                          </span>
                        </div>
                        <span *ngIf="!task.collaborators || task.collaborators.length === 0" class="text-muted">
                          None
                        </span>
                      </div>
                    </td>

                    <!-- Progress Column -->
                    <td>
                      <div class="d-flex flex-column">
                       
                        <div class="progress h-6px w-100px">
                          <div 
                            class="progress-bar"
                            [class.bg-success]="task.progress === 100"
                            [class.bg-primary]="task.progress >= 50 && task.progress < 100"
                            [class.bg-warning]="task.progress < 50"
                            [style.width.%]="task.progress || 0"
                            role="progressbar"></div>
                        </div>
                      </div>
                    </td>
                    
                    <td>
                      <span class="badge fw-bold" [ngClass]="getStatusBadgeClass(task.status)">
                        {{ task.status }}
                      </span>
                    </td>
                    
                    <td class="text-end">
                      <button class="btn btn-bg-light btn-active-color-primary btn-sm" 
                              (click)="openTaskDrawer(task)">
                        View
                      </button>
                    </td>
                  </tr>
                </tbody>
              <!--end::Table body-->
              
          </table>
          <!--end::Table-->
      </div>
    </div>

    <!-- CARD VIEW -->
    <div *ngIf="!isLoadingTasks && selectedView === 'card'">
      <div class="row g-6">
        
        <!-- Empty State -->
        <div class="col-12" *ngIf="tasks.length === 0">
          <div class="card">
            <div class="card-body text-center py-10">
              <i class="ki-outline ki-information-5 fs-3x text-gray-400 mb-3 d-block"></i>
              <div class="fs-5 fw-semibold text-muted">No tasks assigned to this employee yet</div>
            </div>
          </div>
        </div>

        <!-- Task Cards -->
        <div class="col-md-6 col-xl-4" *ngFor="let task of tasks; trackBy: trackByTaskId">
          <div 
            class="card mb-6 border-hover-primary cursor-pointer h-100" 
            (click)="openTaskDrawer(task)">
            <div class="card-body py-6 d-flex flex-column">

              <!-- Top Row -->
              <div class="d-flex justify-content-between align-items-center mb-5">
                <span class="badge fw-bold fs-7" [ngClass]="getStatusBadgeClass(task.status)">
                  {{ task.status }}
                </span>
              </div>

              <!-- Header -->
              <div class="mb-5">
                <a href="#" class="fs-4 fw-bold text-gray-900 mb-3 text-hover-primary d-block" 
                   (click)="$event.preventDefault()">
                  {{ task.title }}
                </a>
                <span class="badge badge-light-primary fw-semibold fs-7">
                  {{ getProjectName(task) }}
                </span>
              </div>

              <div class="separator separator-dashed my-6"></div>
                  <!-- Assigned By -->
                  <div class="d-flex align-items-center mb-6">
                    <span class="text-gray-600 fw-semibold fs-7 me-3">Assigned by:</span>
                    <div class="d-flex align-items-center" *ngIf="task.assignee">
                      <div class="symbol symbol-30px symbol-circle me-2">
                        <img 
                          *ngIf="task.assignee.avatarUrl" 
                          [src]="task.assignee.avatarUrl" 
                          [alt]="task.assignee.firstName + ' ' + task.assignee.lastName"
                          class="object-fit-cover">
                        <span 
                          *ngIf="!task.assignee.avatarUrl"
                          class="symbol-label bg-info text-inverse-info fw-bold fs-7">
                          {{getInitials(task.assignee.firstName, task.assignee.lastName)}}
                        </span>
                      </div>
                      <span class="fw-bold text-gray-800 fs-7">
                        {{task.assignee.firstName}} {{task.assignee.lastName}}
                      </span>
                    </div>
                    <span class="text-muted fs-7" *ngIf="!task.assignee">Not assigned</span>
                  </div>

              <!-- Dates -->
              <div class="d-flex justify-content-between mb-4">
                <div class="d-flex align-items-center">
                  <i class="ki-outline ki-calendar fs-5 text-gray-600 me-2"></i>
                  <span class="text-gray-600 fw-semibold fs-7 me-2">Start:</span>
                  <span class="fw-bold text-gray-800 fs-7">{{ formatDate(task.startDate) }}</span>
                </div>
                <div class="d-flex align-items-center">
                  <i class="ki-outline ki-calendar fs-5 text-danger me-2"></i>
                  <span class="text-gray-600 fw-semibold fs-7 me-2">Due:</span>
                  <span class="fw-bold text-gray-800 fs-7">{{ formatDate(task.dueDate) }}</span>
                </div>
              </div>

              <div class="separator separator-dashed my-6"></div>
              

              <!-- Progress -->
              <div class="mb-6">
                <div class="d-flex justify-content-between align-items-center mb-3">
                  <span class="fs-7 fw-bold text-gray-700">Progress</span>
                  <span class="badge fs-8 fw-bold"
                        [class.badge-light-success]="task.progress === 100"
                        [class.badge-light-primary]="task.progress >= 50 && task.progress < 100"
                        [class.badge-light-warning]="task.progress < 50">
                    {{ task.progress || 0 }}%
                  </span>
                </div>
                <div class="h-6px w-100 bg-light rounded">
                  <div 
                    class="rounded h-6px" 
                    [class.bg-success]="task.progress === 100"
                    [class.bg-primary]="task.progress >= 50 && task.progress < 100"
                    [class.bg-warning]="task.progress < 50"
                    role="progressbar" 
                    [style.width.%]="task.progress || 0" 
                    [attr.aria-valuenow]="task.progress || 0" 
                    aria-valuemin="0" 
                    aria-valuemax="100">
                  </div>
                </div>
              </div>

              <div class="separator separator-dashed my-6"></div>

              <!-- Footer -->
              <div class="d-flex justify-content-between align-items-center mt-auto">
                <!-- Collaborators -->
                <div>
                  <span class="text-gray-600 fw-semibold fs-7 mb-2 d-block">
                    Collaborators ({{ task.collaborators?.length || 0 }})
                  </span>
                  <div class="symbol-group symbol-hover" *ngIf="task.collaborators && task.collaborators.length > 0">
                    <div 
                      class="symbol symbol-35px symbol-circle" 
                      *ngFor="let collab of task.collaborators | slice:0:3"
                      [attr.data-bs-toggle]="'tooltip'"
                      [attr.title]="collab.firstName + ' ' + collab.lastName">
                      <img 
                        *ngIf="collab.avatarUrl" 
                        [src]="collab.avatarUrl" 
                        [alt]="collab.firstName">
                      <span 
                        *ngIf="!collab.avatarUrl"
                        class="symbol-label bg-primary text-inverse-primary fw-bold">
                        {{ getInitials(collab.firstName, collab.lastName) }}
                      </span>
                    </div>
                    <div 
                      class="symbol symbol-35px symbol-circle" 
                      *ngIf="task.collaborators.length > 3"
                      data-bs-toggle="tooltip"
                      [attr.title]="(task.collaborators.length - 3) + ' more'">
                      <span class="symbol-label bg-dark text-gray-300 fs-7 fw-bold">
                        +{{ task.collaborators.length - 3 }}
                      </span>
                    </div>
                  </div>
                  <span class="text-muted fs-7" *ngIf="!task.collaborators || task.collaborators.length === 0">
                    None
                  </span>
                </div>

                <!-- Stats -->
                <div class="d-flex gap-2">
                  <!-- Attachments -->
                  <div class="border border-dashed border-gray-300 rounded d-flex align-items-center py-2 px-3"
                       [title]="(task.attachmentCount || 0) + ' attachment(s)'">
                    <i class="ki-outline ki-paper-clip fs-4 text-gray-600"></i>
                    <span class="ms-1 fs-7 fw-bold text-gray-600">{{ task.attachmentCount || 0 }}</span>
                  </div>
                  
                  <!-- Comments -->
                  <div class="border border-dashed border-gray-300 d-flex align-items-center rounded py-2 px-3"
                       [title]="(task.commentCount || 0) + ' comment(s)'">
                    <i class="ki-outline ki-message-text-2 fs-4 text-gray-600"></i>
                    <span class="ms-1 fs-7 fw-bold text-gray-600">{{ task.commentCount || 0 }}</span>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Pagination (Works for both views) -->
    <div class="d-flex flex-stack flex-wrap pt-10" *ngIf="!isLoadingTasks && tasks.length > 0">
      <div class="fs-6 fw-semibold text-gray-700">
        Showing {{ (currentPage - 1) * pageSize + 1 }} to {{ Math.min(currentPage * pageSize, totalTasks) }} of {{ totalTasks }} entries
      </div>
      <!--begin::Pages-->
      <ul class="pagination">
          <li class="page-item" [class.disabled]="currentPage === 1">
              <a href="#" class="page-link" (click)="previousPage(); $event.preventDefault()">
                  <i class="previous"></i>
              </a>
          </li>
          <li class="page-item" 
              *ngFor="let page of paginationPages"
              [class.active]="page === currentPage">
              <a href="#" class="page-link" (click)="goToPage(page); $event.preventDefault()">
                {{ page }}
              </a>
          </li>
          <li class="page-item" [class.disabled]="currentPage === totalPages">
              <a href="#" class="page-link" (click)="nextPage(); $event.preventDefault()">
                  <i class="next"></i>
              </a>
          </li>
      </ul>
      <!--end::Pages-->
    </div>
  </div>
  <!--end::Tab pane-->
</div>
</div>
<!--end::Tab Content-->

<style>
.cursor-pointer {
cursor: pointer;
transition: all 0.2s ease;
}

.cursor-pointer:hover {
transform: translateY(-2px);
box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.border-hover-primary:hover {
border-color: #3699FF !important;
}
</style>     
                                  
              

								
        </div>
    
      
     </div>
            <!--begin::Row-->
								
								</div>
								<!--end::Content container-->
							</div>
							<!--end::Content-->
						</div>
						<!--end::Content wrapper-->
            
             

						<!--begin::Footer-->
						<div id="kt_app_footer" class="app-footer">
							<!--begin::Footer container-->
							<div class="app-container container-fluid d-flex flex-column flex-md-row flex-center flex-md-stack py-3">
								<!--begin::Copyright-->
								<div class="text-gray-900 order-2 order-md-1">
									<span class="text-muted fw-semibold me-1">2025&copy;</span>
									<a href="#" target="_blank" class="text-gray-800 text-hover-primary">Swift - Office Productivity App</a>
								</div>
								<!--end::Copyright-->
								<!--begin::Menu-->
								<ul class="menu menu-gray-600 menu-hover-primary fw-semibold order-1">
									<li class="menu-item">
										<a href="#" target="_blank" class="menu-link px-2">About</a>
									</li>
									<li class="menu-item">
										<a href="#" target="_blank" class="menu-link px-2">Support</a>
									</li>
									
								</ul>
								<!--end::Menu-->
							</div>
							<!--end::Footer container-->
						</div>
						<!--end::Footer-->
					</div>
					<!--end:::Main-->
				</div>
				<!--end::Wrapper-->
        <app-task-drawer
  *ngIf="isDrawerOpen && selectedTask"
  [isOpen]="isDrawerOpen"
  [task]="selectedTask"
  (closeDrawer)="closeTaskDrawer()"
 
  (taskDeleted)="onTaskDeleted($event)">
</app-task-drawer>